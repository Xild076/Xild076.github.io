<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>9e8e89fa339847859965a8a8ead78765</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section
id="this-notebook-aims-to-understand-how-sentiment-is-aimed-at-named-entities"
class="cell markdown">
<h1>This notebook aims to understand how sentiment is aimed at named
entities</h1>
</section>
<div class="cell code" data-execution_count="123">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spacy <span class="im">import</span> displacy</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Literal</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">&#39;en_core_web_sm&#39;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> analyze_text_structures(text, style: Literal[<span class="st">&quot;dep&quot;</span>, <span class="st">&quot;ent&quot;</span>]):</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    doc <span class="op">=</span> nlp(text)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    displacy.render(doc, style<span class="op">=</span>style, page<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Let's first consider transitive verbs constructions.</p>
<p>This text will serve as an example:</p>
<p>"Adam criticized John's horrible decisions."</p>
<p>Adam will have a netural/positive sentiment because Adam acted
negatively upon the "horrible decision", which would turn positive. John
will have a negative sentiment as John is associated with "horrible
decisions".</p>
<p>Now, let's check out how the dependancies work.</p>
</div>
<div class="cell code" data-execution_count="124">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>analyze_text_structures(<span class="st">&quot;Adam criticized John&#39;s horrible decisions.&quot;</span>, <span class="st">&quot;dep&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<span class="tex2jax_ignore"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:lang="en" id="0207db8d6760403bbc1f65d072a0c6b1-0" class="displacy" width="1100" height="399.5" direction="ltr" style="max-width: none; height: 399.5px; color: #000000; background: #ffffff; font-family: Arial; direction: ltr">
<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="50">Adam</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="50">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="225">criticized</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="225">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="400">John</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="400">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="575">'s</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="575">PART</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="750">horrible</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="750">ADJ</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="925">decisions.</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="925">NOUN</tspan>
</text>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-0207db8d6760403bbc1f65d072a0c6b1-0-0" stroke-width="2px" d="M70,264.5 C70,177.0 215.0,177.0 215.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-0207db8d6760403bbc1f65d072a0c6b1-0-0" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">nsubj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M70,266.5 L62,254.5 78,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-0207db8d6760403bbc1f65d072a0c6b1-0-1" stroke-width="2px" d="M420,264.5 C420,89.5 920.0,89.5 920.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-0207db8d6760403bbc1f65d072a0c6b1-0-1" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">poss</textPath>
    </text>
    <path class="displacy-arrowhead" d="M420,266.5 L412,254.5 428,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-0207db8d6760403bbc1f65d072a0c6b1-0-2" stroke-width="2px" d="M420,264.5 C420,177.0 565.0,177.0 565.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-0207db8d6760403bbc1f65d072a0c6b1-0-2" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">case</textPath>
    </text>
    <path class="displacy-arrowhead" d="M565.0,266.5 L573.0,254.5 557.0,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-0207db8d6760403bbc1f65d072a0c6b1-0-3" stroke-width="2px" d="M770,264.5 C770,177.0 915.0,177.0 915.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-0207db8d6760403bbc1f65d072a0c6b1-0-3" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">amod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M770,266.5 L762,254.5 778,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-0207db8d6760403bbc1f65d072a0c6b1-0-4" stroke-width="2px" d="M245,264.5 C245,2.0 925.0,2.0 925.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-0207db8d6760403bbc1f65d072a0c6b1-0-4" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">dobj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M925.0,266.5 L933.0,254.5 917.0,254.5" fill="currentColor"/>
</g>
</svg></span>
</div>
</div>
<div class="cell markdown">
<p>Alright, so we have the following results.</p>
<p>The easy thing is finding the association between John and the
negative sentiment. The primary source of negative sentiment comes from
the term "horrible decisions", and since John associated with this
negativity, then John is negative. However, since Adam is the subject
criticizing Adam, then Adam is seen in a more positive light.</p>
<p>We can map this interaction out like this:</p>
<p>Subject Entity or Associated Entity (in this case nsubj) -&gt; Verb
-&gt; Object Entity or Associated Entity (in this case dobj + poss)</p>
<p>However, for future reference, we can simply refer to this as Actor
Clause -&gt; Action -&gt; Victim Clause.</p>
<p>Given that, the pattern I observe is so far is that:</p>
<p>Subj -&gt; Positive Verb -&gt; Obj (Negative Sentiment) = Negative
Sentiment towards Subj Subj -&gt; Negative Verb -&gt; Obj (Negative
Sentiment) = Positive Sentiment towards Subj Subj -&gt; Positive Verb
-&gt; Obj (Positive Sentiment) = Positive Sentiment towards Subj Subj
-&gt; Negative Verb -&gt; Obj (Positive Sentiment) = Negative Sentiment
towards Subj</p>
<p>Given all this, let's check out how the numbers would play out. For
this analysis, I will be using VADER sentiment analysis.</p>
</div>
<div class="cell code" data-execution_count="125">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> vaderSentiment.vaderSentiment <span class="im">import</span> SentimentIntensityAnalyzer</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sia <span class="op">=</span> SentimentIntensityAnalyzer()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam criticized John&#39;s horrible decisions.&quot;</span>))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam criticized&quot;</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;John&#39;s horrible decisions.&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>{&#39;neg&#39;: 0.667, &#39;neu&#39;: 0.333, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.7184}
{&#39;neg&#39;: 0.714, &#39;neu&#39;: 0.286, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.3612}
{&#39;neg&#39;: 0.636, &#39;neu&#39;: 0.364, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.5423}
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>From this, we can see two key things. First, the sentiment associated
with John would be about -0.5423. However, what would the sentiment
associated with Adam be?</p>
<p>While this may seem arbritrary, I simply multiplied the two together
(as the sentiment patterns fit surprisingly well into math) to get a
sentiment of about 0.19587876, or mildly positive.</p>
<p>However, there are still are two main conditions I don't understand:
sentence structure and descriptive cases (descriptive voice means that
"the sad person"â€”sad brings a negtive connotation but a positive verb
towards the sad person would reflect well on the subject instead of
negatively).</p>
<p>Given that, let's first look at the more straight-forward and
possibly more difficult: sentence stucture. There are many different
sentence structures, and determining the characters and their
interactions is very difficult. However, we can boil it down to the very
essentials to make things simpler: all we need to know is the actor and
all associated clauses.</p>
</div>
<div class="cell code" data-execution_count="126">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>analyze_text_structures(<span class="st">&quot;John&#39;s horrible decisions were criticized by Adam.&quot;</span>, <span class="st">&quot;dep&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<span class="tex2jax_ignore"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:lang="en" id="6956a3ff4c8644d8a3b2272d60142448-0" class="displacy" width="1450" height="312.0" direction="ltr" style="max-width: none; height: 312.0px; color: #000000; background: #ffffff; font-family: Arial; direction: ltr">
<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="50">John</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="50">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="225">'s</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="225">PART</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="400">horrible</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="400">ADJ</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="575">decisions</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="575">NOUN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="750">were</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="750">AUX</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="925">criticized</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="925">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="1100">by</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1100">ADP</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="1275">Adam.</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1275">PROPN</tspan>
</text>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6956a3ff4c8644d8a3b2272d60142448-0-0" stroke-width="2px" d="M70,177.0 C70,2.0 575.0,2.0 575.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6956a3ff4c8644d8a3b2272d60142448-0-0" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">poss</textPath>
    </text>
    <path class="displacy-arrowhead" d="M70,179.0 L62,167.0 78,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6956a3ff4c8644d8a3b2272d60142448-0-1" stroke-width="2px" d="M70,177.0 C70,89.5 220.0,89.5 220.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6956a3ff4c8644d8a3b2272d60142448-0-1" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">case</textPath>
    </text>
    <path class="displacy-arrowhead" d="M220.0,179.0 L228.0,167.0 212.0,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6956a3ff4c8644d8a3b2272d60142448-0-2" stroke-width="2px" d="M420,177.0 C420,89.5 570.0,89.5 570.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6956a3ff4c8644d8a3b2272d60142448-0-2" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">amod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M420,179.0 L412,167.0 428,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6956a3ff4c8644d8a3b2272d60142448-0-3" stroke-width="2px" d="M595,177.0 C595,2.0 925.0,2.0 925.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6956a3ff4c8644d8a3b2272d60142448-0-3" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">nsubjpass</textPath>
    </text>
    <path class="displacy-arrowhead" d="M595,179.0 L587,167.0 603,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6956a3ff4c8644d8a3b2272d60142448-0-4" stroke-width="2px" d="M770,177.0 C770,89.5 920.0,89.5 920.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6956a3ff4c8644d8a3b2272d60142448-0-4" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">auxpass</textPath>
    </text>
    <path class="displacy-arrowhead" d="M770,179.0 L762,167.0 778,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6956a3ff4c8644d8a3b2272d60142448-0-5" stroke-width="2px" d="M945,177.0 C945,89.5 1095.0,89.5 1095.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6956a3ff4c8644d8a3b2272d60142448-0-5" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">agent</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1095.0,179.0 L1103.0,167.0 1087.0,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6956a3ff4c8644d8a3b2272d60142448-0-6" stroke-width="2px" d="M1120,177.0 C1120,89.5 1270.0,89.5 1270.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6956a3ff4c8644d8a3b2272d60142448-0-6" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">pobj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1270.0,179.0 L1278.0,167.0 1262.0,167.0" fill="currentColor"/>
</g>
</svg></span>
</div>
</div>
<div class="cell code" data-execution_count="127">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>analyze_text_structures(<span class="st">&quot;Adam ordered John to stop eating in a late-night hateful rant.&quot;</span>, <span class="st">&quot;dep&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<span class="tex2jax_ignore"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:lang="en" id="b1346c42f69141f59055293080c946c2-0" class="displacy" width="2150" height="487.0" direction="ltr" style="max-width: none; height: 487.0px; color: #000000; background: #ffffff; font-family: Arial; direction: ltr">
<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="50">Adam</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="50">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="225">ordered</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="225">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="400">John</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="400">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="575">to</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="575">PART</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="750">stop</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="750">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="925">eating</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="925">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1100">in</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1100">ADP</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1275">a</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1275">DET</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1450">late-</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1450">ADJ</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1625">night</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1625">NOUN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1800">hateful</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1800">ADJ</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1975">rant.</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1975">NOUN</tspan>
</text>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-b1346c42f69141f59055293080c946c2-0-0" stroke-width="2px" d="M70,352.0 C70,264.5 210.0,264.5 210.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-b1346c42f69141f59055293080c946c2-0-0" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">nsubj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M70,354.0 L62,342.0 78,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-b1346c42f69141f59055293080c946c2-0-1" stroke-width="2px" d="M245,352.0 C245,264.5 385.0,264.5 385.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-b1346c42f69141f59055293080c946c2-0-1" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">dobj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M385.0,354.0 L393.0,342.0 377.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-b1346c42f69141f59055293080c946c2-0-2" stroke-width="2px" d="M595,352.0 C595,264.5 735.0,264.5 735.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-b1346c42f69141f59055293080c946c2-0-2" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">aux</textPath>
    </text>
    <path class="displacy-arrowhead" d="M595,354.0 L587,342.0 603,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-b1346c42f69141f59055293080c946c2-0-3" stroke-width="2px" d="M245,352.0 C245,177.0 740.0,177.0 740.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-b1346c42f69141f59055293080c946c2-0-3" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">xcomp</textPath>
    </text>
    <path class="displacy-arrowhead" d="M740.0,354.0 L748.0,342.0 732.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-b1346c42f69141f59055293080c946c2-0-4" stroke-width="2px" d="M770,352.0 C770,264.5 910.0,264.5 910.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-b1346c42f69141f59055293080c946c2-0-4" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">xcomp</textPath>
    </text>
    <path class="displacy-arrowhead" d="M910.0,354.0 L918.0,342.0 902.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-b1346c42f69141f59055293080c946c2-0-5" stroke-width="2px" d="M945,352.0 C945,264.5 1085.0,264.5 1085.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-b1346c42f69141f59055293080c946c2-0-5" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">prep</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1085.0,354.0 L1093.0,342.0 1077.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-b1346c42f69141f59055293080c946c2-0-6" stroke-width="2px" d="M1295,352.0 C1295,89.5 1970.0,89.5 1970.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-b1346c42f69141f59055293080c946c2-0-6" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">det</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1295,354.0 L1287,342.0 1303,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-b1346c42f69141f59055293080c946c2-0-7" stroke-width="2px" d="M1470,352.0 C1470,264.5 1610.0,264.5 1610.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-b1346c42f69141f59055293080c946c2-0-7" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">amod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1470,354.0 L1462,342.0 1478,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-b1346c42f69141f59055293080c946c2-0-8" stroke-width="2px" d="M1645,352.0 C1645,177.0 1965.0,177.0 1965.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-b1346c42f69141f59055293080c946c2-0-8" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">nmod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1645,354.0 L1637,342.0 1653,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-b1346c42f69141f59055293080c946c2-0-9" stroke-width="2px" d="M1820,352.0 C1820,264.5 1960.0,264.5 1960.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-b1346c42f69141f59055293080c946c2-0-9" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">amod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1820,354.0 L1812,342.0 1828,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-b1346c42f69141f59055293080c946c2-0-10" stroke-width="2px" d="M1120,352.0 C1120,2.0 1975.0,2.0 1975.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-b1346c42f69141f59055293080c946c2-0-10" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">pobj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1975.0,354.0 L1983.0,342.0 1967.0,342.0" fill="currentColor"/>
</g>
</svg></span>
</div>
</div>
<div class="cell code" data-execution_count="128">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>analyze_text_structures(<span class="st">&quot;While ranting hatefully, Adam ordered John to stop eating.&quot;</span>, <span class="st">&quot;dep&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<span class="tex2jax_ignore"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:lang="en" id="6213e56c02d4404eacf12a7f63160635-0" class="displacy" width="1625" height="312.0" direction="ltr" style="max-width: none; height: 312.0px; color: #000000; background: #ffffff; font-family: Arial; direction: ltr">
<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="50">While</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="50">SCONJ</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="225">ranting</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="225">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="400">hatefully,</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="400">ADV</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="575">Adam</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="575">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="750">ordered</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="750">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="925">John</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="925">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="1100">to</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1100">PART</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="1275">stop</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1275">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="222.0">
    <tspan class="displacy-word" fill="currentColor" x="1450">eating.</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1450">VERB</tspan>
</text>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6213e56c02d4404eacf12a7f63160635-0-0" stroke-width="2px" d="M70,177.0 C70,89.5 220.0,89.5 220.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6213e56c02d4404eacf12a7f63160635-0-0" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">mark</textPath>
    </text>
    <path class="displacy-arrowhead" d="M70,179.0 L62,167.0 78,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6213e56c02d4404eacf12a7f63160635-0-1" stroke-width="2px" d="M245,177.0 C245,2.0 750.0,2.0 750.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6213e56c02d4404eacf12a7f63160635-0-1" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">advcl</textPath>
    </text>
    <path class="displacy-arrowhead" d="M245,179.0 L237,167.0 253,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6213e56c02d4404eacf12a7f63160635-0-2" stroke-width="2px" d="M245,177.0 C245,89.5 395.0,89.5 395.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6213e56c02d4404eacf12a7f63160635-0-2" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">advmod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M395.0,179.0 L403.0,167.0 387.0,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6213e56c02d4404eacf12a7f63160635-0-3" stroke-width="2px" d="M595,177.0 C595,89.5 745.0,89.5 745.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6213e56c02d4404eacf12a7f63160635-0-3" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">nsubj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M595,179.0 L587,167.0 603,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6213e56c02d4404eacf12a7f63160635-0-4" stroke-width="2px" d="M770,177.0 C770,89.5 920.0,89.5 920.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6213e56c02d4404eacf12a7f63160635-0-4" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">dobj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M920.0,179.0 L928.0,167.0 912.0,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6213e56c02d4404eacf12a7f63160635-0-5" stroke-width="2px" d="M1120,177.0 C1120,89.5 1270.0,89.5 1270.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6213e56c02d4404eacf12a7f63160635-0-5" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">aux</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1120,179.0 L1112,167.0 1128,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6213e56c02d4404eacf12a7f63160635-0-6" stroke-width="2px" d="M770,177.0 C770,2.0 1275.0,2.0 1275.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6213e56c02d4404eacf12a7f63160635-0-6" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">xcomp</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1275.0,179.0 L1283.0,167.0 1267.0,167.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-6213e56c02d4404eacf12a7f63160635-0-7" stroke-width="2px" d="M1295,177.0 C1295,89.5 1445.0,89.5 1445.0,177.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-6213e56c02d4404eacf12a7f63160635-0-7" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">xcomp</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1445.0,179.0 L1453.0,167.0 1437.0,167.0" fill="currentColor"/>
</g>
</svg></span>
</div>
</div>
<div class="cell code" data-execution_count="129">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>analyze_text_structures(<span class="st">&quot;Adam, a horrible person, ordered John to stop eating.&quot;</span>, <span class="st">&quot;dep&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<span class="tex2jax_ignore"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:lang="en" id="24bad590bb134e82806dc37a7acd416b-0" class="displacy" width="1625" height="487.0" direction="ltr" style="max-width: none; height: 487.0px; color: #000000; background: #ffffff; font-family: Arial; direction: ltr">
<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="50">Adam,</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="50">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="225">a</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="225">DET</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="400">horrible</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="400">ADJ</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="575">person,</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="575">NOUN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="750">ordered</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="750">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="925">John</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="925">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1100">to</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1100">PART</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1275">stop</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1275">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1450">eating.</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1450">VERB</tspan>
</text>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-24bad590bb134e82806dc37a7acd416b-0-0" stroke-width="2px" d="M70,352.0 C70,2.0 750.0,2.0 750.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-24bad590bb134e82806dc37a7acd416b-0-0" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">nsubj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M70,354.0 L62,342.0 78,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-24bad590bb134e82806dc37a7acd416b-0-1" stroke-width="2px" d="M245,352.0 C245,177.0 565.0,177.0 565.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-24bad590bb134e82806dc37a7acd416b-0-1" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">det</textPath>
    </text>
    <path class="displacy-arrowhead" d="M245,354.0 L237,342.0 253,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-24bad590bb134e82806dc37a7acd416b-0-2" stroke-width="2px" d="M420,352.0 C420,264.5 560.0,264.5 560.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-24bad590bb134e82806dc37a7acd416b-0-2" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">amod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M420,354.0 L412,342.0 428,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-24bad590bb134e82806dc37a7acd416b-0-3" stroke-width="2px" d="M70,352.0 C70,89.5 570.0,89.5 570.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-24bad590bb134e82806dc37a7acd416b-0-3" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">appos</textPath>
    </text>
    <path class="displacy-arrowhead" d="M570.0,354.0 L578.0,342.0 562.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-24bad590bb134e82806dc37a7acd416b-0-4" stroke-width="2px" d="M770,352.0 C770,264.5 910.0,264.5 910.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-24bad590bb134e82806dc37a7acd416b-0-4" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">dobj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M910.0,354.0 L918.0,342.0 902.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-24bad590bb134e82806dc37a7acd416b-0-5" stroke-width="2px" d="M1120,352.0 C1120,264.5 1260.0,264.5 1260.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-24bad590bb134e82806dc37a7acd416b-0-5" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">aux</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1120,354.0 L1112,342.0 1128,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-24bad590bb134e82806dc37a7acd416b-0-6" stroke-width="2px" d="M770,352.0 C770,177.0 1265.0,177.0 1265.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-24bad590bb134e82806dc37a7acd416b-0-6" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">xcomp</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1265.0,354.0 L1273.0,342.0 1257.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-24bad590bb134e82806dc37a7acd416b-0-7" stroke-width="2px" d="M1295,352.0 C1295,264.5 1435.0,264.5 1435.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-24bad590bb134e82806dc37a7acd416b-0-7" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">xcomp</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1435.0,354.0 L1443.0,342.0 1427.0,342.0" fill="currentColor"/>
</g>
</svg></span>
</div>
</div>
<div class="cell code" data-execution_count="130">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>analyze_text_structures(<span class="st">&quot;John was ordered to stop eating by Adam in a late-night hateful rant.&quot;</span>, <span class="st">&quot;dep&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<span class="tex2jax_ignore"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:lang="en" id="849c9578395b4f1c9c4a6f9d662b6d25-0" class="displacy" width="2500" height="487.0" direction="ltr" style="max-width: none; height: 487.0px; color: #000000; background: #ffffff; font-family: Arial; direction: ltr">
<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="50">John</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="50">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="225">was</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="225">AUX</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="400">ordered</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="400">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="575">to</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="575">PART</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="750">stop</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="750">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="925">eating</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="925">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1100">by</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1100">ADP</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1275">Adam</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1275">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1450">in</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1450">ADP</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1625">a</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1625">DET</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1800">late-</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1800">ADJ</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="1975">night</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1975">NOUN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="2150">hateful</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="2150">ADJ</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="397.0">
    <tspan class="displacy-word" fill="currentColor" x="2325">rant.</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="2325">NOUN</tspan>
</text>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-0" stroke-width="2px" d="M70,352.0 C70,177.0 390.0,177.0 390.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-0" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">nsubjpass</textPath>
    </text>
    <path class="displacy-arrowhead" d="M70,354.0 L62,342.0 78,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-1" stroke-width="2px" d="M245,352.0 C245,264.5 385.0,264.5 385.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-1" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">auxpass</textPath>
    </text>
    <path class="displacy-arrowhead" d="M245,354.0 L237,342.0 253,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-2" stroke-width="2px" d="M595,352.0 C595,264.5 735.0,264.5 735.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-2" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">aux</textPath>
    </text>
    <path class="displacy-arrowhead" d="M595,354.0 L587,342.0 603,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-3" stroke-width="2px" d="M420,352.0 C420,177.0 740.0,177.0 740.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-3" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">xcomp</textPath>
    </text>
    <path class="displacy-arrowhead" d="M740.0,354.0 L748.0,342.0 732.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-4" stroke-width="2px" d="M770,352.0 C770,264.5 910.0,264.5 910.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-4" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">xcomp</textPath>
    </text>
    <path class="displacy-arrowhead" d="M910.0,354.0 L918.0,342.0 902.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-5" stroke-width="2px" d="M945,352.0 C945,264.5 1085.0,264.5 1085.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-5" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">prep</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1085.0,354.0 L1093.0,342.0 1077.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-6" stroke-width="2px" d="M1120,352.0 C1120,264.5 1260.0,264.5 1260.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-6" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">pobj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1260.0,354.0 L1268.0,342.0 1252.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-7" stroke-width="2px" d="M770,352.0 C770,177.0 1440.0,177.0 1440.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-7" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">prep</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1440.0,354.0 L1448.0,342.0 1432.0,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-8" stroke-width="2px" d="M1645,352.0 C1645,89.5 2320.0,89.5 2320.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-8" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">det</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1645,354.0 L1637,342.0 1653,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-9" stroke-width="2px" d="M1820,352.0 C1820,264.5 1960.0,264.5 1960.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-9" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">amod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1820,354.0 L1812,342.0 1828,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-10" stroke-width="2px" d="M1995,352.0 C1995,177.0 2315.0,177.0 2315.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-10" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">nmod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1995,354.0 L1987,342.0 2003,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-11" stroke-width="2px" d="M2170,352.0 C2170,264.5 2310.0,264.5 2310.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-11" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">amod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M2170,354.0 L2162,342.0 2178,342.0" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-12" stroke-width="2px" d="M1470,352.0 C1470,2.0 2325.0,2.0 2325.0,352.0" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-849c9578395b4f1c9c4a6f9d662b6d25-0-12" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">pobj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M2325.0,354.0 L2333.0,342.0 2317.0,342.0" fill="currentColor"/>
</g>
</svg></span>
</div>
</div>
<div class="cell code" data-execution_count="131">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>analyze_text_structures(<span class="st">&quot;While ranting hatefully, John was ordered to stop eating by Adam.&quot;</span>, <span class="st">&quot;dep&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<span class="tex2jax_ignore"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:lang="en" id="5e96ad89399749eeae3bfa5114fd4d7d-0" class="displacy" width="1975" height="399.5" direction="ltr" style="max-width: none; height: 399.5px; color: #000000; background: #ffffff; font-family: Arial; direction: ltr">
<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="50">While</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="50">SCONJ</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="225">ranting</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="225">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="400">hatefully,</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="400">ADV</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="575">John</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="575">PROPN</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="750">was</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="750">AUX</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="925">ordered</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="925">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="1100">to</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1100">PART</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="1275">stop</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1275">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="1450">eating</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1450">VERB</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="1625">by</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1625">ADP</tspan>
</text>

<text class="displacy-token" fill="currentColor" text-anchor="middle" y="309.5">
    <tspan class="displacy-word" fill="currentColor" x="1800">Adam.</tspan>
    <tspan class="displacy-tag" dy="2em" fill="currentColor" x="1800">PROPN</tspan>
</text>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-0" stroke-width="2px" d="M70,264.5 C70,177.0 215.0,177.0 215.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-0" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">mark</textPath>
    </text>
    <path class="displacy-arrowhead" d="M70,266.5 L62,254.5 78,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-1" stroke-width="2px" d="M245,264.5 C245,2.0 925.0,2.0 925.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-1" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">advcl</textPath>
    </text>
    <path class="displacy-arrowhead" d="M245,266.5 L237,254.5 253,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-2" stroke-width="2px" d="M245,264.5 C245,177.0 390.0,177.0 390.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-2" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">advmod</textPath>
    </text>
    <path class="displacy-arrowhead" d="M390.0,266.5 L398.0,254.5 382.0,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-3" stroke-width="2px" d="M595,264.5 C595,89.5 920.0,89.5 920.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-3" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">nsubjpass</textPath>
    </text>
    <path class="displacy-arrowhead" d="M595,266.5 L587,254.5 603,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-4" stroke-width="2px" d="M770,264.5 C770,177.0 915.0,177.0 915.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-4" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">auxpass</textPath>
    </text>
    <path class="displacy-arrowhead" d="M770,266.5 L762,254.5 778,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-5" stroke-width="2px" d="M1120,264.5 C1120,177.0 1265.0,177.0 1265.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-5" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">aux</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1120,266.5 L1112,254.5 1128,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-6" stroke-width="2px" d="M945,264.5 C945,89.5 1270.0,89.5 1270.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-6" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">xcomp</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1270.0,266.5 L1278.0,254.5 1262.0,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-7" stroke-width="2px" d="M1295,264.5 C1295,177.0 1440.0,177.0 1440.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-7" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">xcomp</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1440.0,266.5 L1448.0,254.5 1432.0,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-8" stroke-width="2px" d="M1470,264.5 C1470,177.0 1615.0,177.0 1615.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-8" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">prep</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1615.0,266.5 L1623.0,254.5 1607.0,254.5" fill="currentColor"/>
</g>

<g class="displacy-arrow">
    <path class="displacy-arc" id="arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-9" stroke-width="2px" d="M1645,264.5 C1645,177.0 1790.0,177.0 1790.0,264.5" fill="none" stroke="currentColor"/>
    <text dy="1.25em" style="font-size: 0.8em; letter-spacing: 1px">
        <textPath xlink:href="#arrow-5e96ad89399749eeae3bfa5114fd4d7d-0-9" class="displacy-label" startOffset="50%" side="left" fill="currentColor" text-anchor="middle">pobj</textPath>
    </text>
    <path class="displacy-arrowhead" d="M1790.0,266.5 L1798.0,254.5 1782.0,254.5" fill="currentColor"/>
</g>
</svg></span>
</div>
</div>
<div class="cell markdown">
<p>Alright, so what do we see here?</p>
<p>Surprisingly, the patterns are pretty simple!</p>
<p>First, in a passive voice scenario ("John's horrible decisions were
criticized by Adam."):</p>
<ol>
<li>The Actor clause is Adam (pobj)</li>
<li>The Action is "were criticized by"</li>
<li>The Victim clause is John's horrible decisions (nsubjpass)</li>
</ol>
<p>Next, in an active voice complex sentence with a final prepositional
phrase modifier ("Adam ordered John stop eating in a late-night hateful
rant."): This case is a little more special because we have the added on
"in a late-night hateful rant". This can either belong to the actor
clause or the victim clause, so let's take a look at another sentence to
be sure.</p>
<p>This is the passive voice version of the sentence: "John was ordered
to stop eating by Adam in a late-night hateful rant." In this case, it
seems that "in a late-night hateful rant" is once again associated with
Adam, implying that a final prepositional phrase modifier is more
commonly associated with the active actor instead of the subject.</p>
<p>Thus, for both, we can determine that:</p>
<ol>
<li>The Actor clause is Adam (nsubj/pobj) and "in a late-night hateful
rant" (prep)</li>
<li>The Action is "ordered"/"was ordered" and "to stop eating"
(xcomp)</li>
<li>The Victim clause is "John" (dobj/nsubjpass)</li>
</ol>
<p>Now, let's look at a similar case but with "While ranting hatefully,
John was ordered to stop eating by Adam." and "While ranting hatefully,
Adam ordered John to stop eating." For this one, the dependent clause
(advcl) seems to always be associated with the nsubj in some way.</p>
<p>Thus, it can be determined that for the first sentence:</p>
<ol>
<li>The Actor clause is Adam (pobj)</li>
<li>The Action is "was ordered to stop eating"</li>
<li>The Victim clause is "While ranting hatefully" (advcl) and "John"
(nsubjpass)</li>
</ol>
<p>Meanwhile, for the second sentence:</p>
<ol>
<li>The Actor clause is "While ranting hatefully" (advcl) and "Adam"
(nsubj)</li>
<li>The Action is "ordered" and "to stop eating" (xcomp)</li>
<li>The Victim clause is "John"</li>
</ol>
<p>Finally, let's look at "Adam, a horrible person, ordered John to stop
eating." This one was actually way simpler than all the other ones as "a
horrible person" was associated to Adam with appos. That means that we
can easily determine that:</p>
<ol>
<li>The Actor clause is "Adam, a horrible person,"</li>
<li>The Action is "ordered" and "to stop eating" (xcomp)</li>
<li>The Victim clause is "John"</li>
</ol>
<p>Thus, we have the general rules:</p>
<ol>
<li>The Actor clause is the clause of the actor/perpetrator who performs
the action
<ul>
<li>Associated information includes anything attached with advcl, poss,
or prep</li>
<li>There are possibly more rules involved, just ones I haven't
discovered yet</li>
</ul></li>
<li>The Action is the verb and associated information with xcomp.</li>
<li>The Victim clause is the clause of the victim/reviever who recieves
the action
<ul>
<li>Associated information includes anything attached with advcl, or
poss</li>
</ul></li>
<li>Any named entities within each of the clauses will be associated
with the sentiment of the clauses as a whole.</li>
</ol>
<p>Now the curiosity comes in when we have to try to find sentiments. We
established before that we have to multiply the sentiment of the Victim
clause with the sentiment of the Actor + Action clauses. However, things
became slightly more muddled since, with the advent of sentiment within
the actor clause, we need to see how this affects the sentence as a
whole.</p>
<p>Let's take a look at three cases.</p>
</div>
<div class="cell code" data-execution_count="132">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># John&#39;s horrible decisions were criticized by Adam.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam ordered John to stop eating in a late-night hateful rant.&quot;</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam in a late-night hateful rant&quot;</span>)) <span class="co"># Actor clause</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam ordered in a late-night hateful rant&quot;</span>)) <span class="co"># Actor clause + Action</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam ordered to stop eating&quot;</span>)) <span class="co"># Actor clause subject + Action</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;John&quot;</span>)) <span class="co"># Victim clause</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># While ranting hatefully, John was ordered to stop eating by Adam.</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;While ranting hatefully, John was ordered to stop eating by Adam.&quot;</span>))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;While ranting hatefully, John&quot;</span>)) <span class="co"># Victim clause</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam&quot;</span>)) <span class="co"># Actor clause</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;was ordered to stop eating by Adam.&quot;</span>)) <span class="co"># Actor clause + Action</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;was ordered to stop eating by Adam.&quot;</span>)) <span class="co"># Actor clause subject + Action</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Adam, a horrible person, ordered John to stop eating.</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam, a horrible person, ordered John to stop eating.&quot;</span>))</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam, a horrible person,&quot;</span>)) <span class="co"># Actor clause</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam, a horrible person, ordered&quot;</span>)) <span class="co"># Actor clause + Action</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam ordered&quot;</span>)) <span class="co"># Actor clause subject + Action</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;John to stop eating.&quot;</span>)) <span class="co"># Victim clause</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>{&#39;neg&#39;: 0.494, &#39;neu&#39;: 0.506, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.7783}
{&#39;neg&#39;: 0.583, &#39;neu&#39;: 0.417, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.6808}
{&#39;neg&#39;: 0.528, &#39;neu&#39;: 0.472, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.6808}
{&#39;neg&#39;: 0.355, &#39;neu&#39;: 0.645, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.296}
{&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}

{&#39;neg&#39;: 0.379, &#39;neu&#39;: 0.621, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.6705}
{&#39;neg&#39;: 0.524, &#39;neu&#39;: 0.476, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.5106}
{&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}
{&#39;neg&#39;: 0.268, &#39;neu&#39;: 0.732, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.296}
{&#39;neg&#39;: 0.268, &#39;neu&#39;: 0.732, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.296}

{&#39;neg&#39;: 0.449, &#39;neu&#39;: 0.551, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.6908}
{&#39;neg&#39;: 0.538, &#39;neu&#39;: 0.462, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.5423}
{&#39;neg&#39;: 0.467, &#39;neu&#39;: 0.533, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.5423}
{&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}
{&#39;neg&#39;: 0.423, &#39;neu&#39;: 0.577, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.296}
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Okay, we have some interesting numbers to play with.</p>
<p>Now, I split the the sentiments into 4 different types: Actor clause,
Actor clause + Action, Actor clause subject + Action, and Victim
clause.</p>
<p>The only three important ones are Actor clause, Actor clause subject
+ Action, and Victim clause.</p>
<p>The new one here is Actor clause subject + Action. Previously, I used
Actor clause + Action, however, I realized that this meant that I
couldn't get what the verb is actually implying, I decided to purely use
the Actor clause subject with the action to determine the sentiment of
the action.</p>
<p>So, we have the following information (using "Adam ordered John stop
eating in a late-night hateful rant." as an example):</p>
<ul>
<li>The Actor clause ("Adam in a late-night hateful rant") -&gt; -0.6808
(AC)</li>
<li>The Actor clause subject + action ("Adam ordered to stop eating")
-&gt; -0.296 (ACS+A)</li>
<li>The Victim clause ("John") -&gt; 0.0 (VC)</li>
</ul>
<p>So, how do we calculate sentiment? First, let's get a sense of what
sentiment we should feel towards each character. Adam should face a very
negative sentiment while John face a positive one. So, how do we achieve
that?</p>
<p>Well, going off of the previous one, to get the Actor clause
sentiment, we would multiple the ACS+A with the VC to get 0.0 and
average it with AC, but that seems odd, as aiming a negative sentiment
at a neutral target would normally be considered a negative thing to do.
However, let's just go with it for now. The results would come out to be
a compound -0.3404 sentiment for AC.</p>
<p>Meanwhile, doing the opposite for the VC, the we would multiply ASC+A
with AC to get a compound 0.1007584 sentiment for the VC. That seems
pretty accurate.</p>
<p>Thus, we can derive the equation to calculate entity sentiment:</p>
<p>Compound A/VC Sentiment = (V/AC * ASC+A + A/VC) / 2</p>
<p>Pretty neat, pretty simple, though it does decrease the sentiment
intensity. For now, we have a pretty simple way to semi-reliably
calculate the sentiment aimed at an entity!</p>
<p>Now, though, let's list out and tackle the big three issues all at
once.</p>
<ul>
<li>Descriptive (ex: happy, sad, tall, short) vs Evaluative (ex:
horrible, bad, good, helpful) descriptors</li>
<li>Sentiment mitigation and neutral sentiment cases</li>
<li>VADER's failures.</li>
</ul>
<p>First, let's solve the easiest issue: Vader's failures.</p>
<p>The thing about Vader is that Vader:</p>
<ol>
<li>Fails to understand things like sarcasm</li>
<li>Has a massively limited wordbank and range (especially compared to
newer tools)</li>
</ol>
<p>We can ignore the first issue as we aren't too worried about sarcasm
right now since our focus is determining sentiment target rather than
textual nuances.</p>
<p>However, the second issue is a pretty big problem. Just take a look
at how it handles these sentences:</p>
</div>
<div class="cell code" data-execution_count="133">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam ordered.&quot;</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam had a freak-out.&quot;</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sia.polarity_scores(<span class="st">&quot;Adam did harmful things.&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>{&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}
{&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}
{&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Well... the first one makes sense but the other two are just
ridiculous. "Harmful" and "freak-out" are definately negative.</p>
<p>Now, let's try to solve this! Solving this is pretty simpleâ€”let's
just look at other tools instead and agregate a solution together! Let's
use the same three examples.</p>
</div>
<div class="cell code" data-execution_count="134">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> textblob <span class="im">import</span> TextBlob</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> afinn <span class="im">import</span> Afinn</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Textblob sentiment:&quot;</span>, TextBlob(<span class="st">&quot;Adam ordered.&quot;</span>).sentiment)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Textblob sentiment:&quot;</span>, TextBlob(<span class="st">&quot;Adam had a freak-out.&quot;</span>).sentiment)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Textblob sentiment:&quot;</span>, TextBlob(<span class="st">&quot;Adam did harmful things.&quot;</span>).sentiment)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>afn <span class="op">=</span> Afinn()</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;AFINN sentiment:&quot;</span>, afn.score_with_wordlist(<span class="st">&quot;Adam ordered.&quot;</span>))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;AFINN sentiment:&quot;</span>, afn.score_with_wordlist(<span class="st">&quot;Adam had a freak-out.&quot;</span>))</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;AFINN sentiment:&quot;</span>, afn.score_with_wordlist(<span class="st">&quot;Adam did harmful things.&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Textblob sentiment: Sentiment(polarity=0.0, subjectivity=0.0)
Textblob sentiment: Sentiment(polarity=0.0, subjectivity=0.0)
Textblob sentiment: Sentiment(polarity=0.0, subjectivity=0.0)

AFINN sentiment: 0.0
AFINN sentiment: -2.0
AFINN sentiment: -2.0
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Well... these results don't look good for textblob, though they look
better for AFINN, which makes sense, since AFINN operates purely on the
words in the sentences.</p>
<p>So, how do we aggregate these results? Once again, while this may be
crude, I decided to normalize AFINN with the total number of words
tested, dividing them over 5, and average them with the Vader
scores.</p>
</div>
<div class="cell code" data-execution_count="135">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>afn <span class="op">=</span> Afinn()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>sia <span class="op">=</span> SentimentIntensityAnalyzer()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalized_afinn_score(text):</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> nltk.word_tokenize(text)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    word_scores <span class="op">=</span> [afn.score(word) <span class="cf">for</span> word <span class="kw">in</span> tokens]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    relevant_scores <span class="op">=</span> [s <span class="cf">for</span> s <span class="kw">in</span> word_scores <span class="cf">if</span> s <span class="op">!=</span> <span class="dv">0</span>]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> relevant_scores:</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sum</span>(relevant_scores) <span class="op">/</span> <span class="bu">len</span>(relevant_scores) <span class="op">/</span> <span class="dv">5</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_sentiment(text):</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    afn_score <span class="op">=</span> normalized_afinn_score(text)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    polarity_score <span class="op">=</span> sia.polarity_scores(text)[<span class="st">&#39;compound&#39;</span>]</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (afn_score <span class="op">+</span> polarity_score) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>test_text <span class="op">=</span> <span class="st">&quot;Adam had a freak-out and did harmful things.&quot;</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Aggregate sentiment:&quot;</span>, get_sentiment(test_text))</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;AFINN sentiment:&quot;</span>, normalized_afinn_score(test_text))</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Polarity sentiment:&quot;</span>, sia.polarity_scores(test_text))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Aggregate sentiment: -0.2
AFINN sentiment: -0.4
Polarity sentiment: {&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>I'll be the first to admit that this is more than just "cobbled
together", this is downright falling apart. But it's good enough for
now, so let's move on to tacklign issue #2: sentiment mitigation and
neutral sentiment cases.</p>
<p>Let's go back to the Adam example.</p>
<ul>
<li>The Actor clause ("Adam in a late-night hateful rant") -&gt; -0.6808
(AC)</li>
<li>The Actor clause subject + action ("Adam ordered to stop eating")
-&gt; -0.296 (ACS+A)</li>
<li>The Victim clause ("John") -&gt; 0.0 (VC)</li>
</ul>
<p>Given: Compound A/VC Sentiment = (V/AC * ASC+A + A/VC) / 2, as
mentioned before, the sentiment multiplied together would be 0.0 *
-0.6808 = 0, which makes no sense. After all, taking action against a
neutral individual is still negative. Thus, I decided to modify the
equation slightly to reflect this by giving an addative to the compount
sentiments and by adding a 1/3 weighing ratio:</p>
<p>Compound A/VC Sentiment = ((V/AC + 1) * ASC+A + A/VC * 3) / 4, V/AC
&gt;= 0 Compound A/VC Sentiment = ((V/AC - 1) * ASC+A + A/VC * 3) / 4,
V/AC &lt; 0</p>
<p>I did this because:</p>
<ul>
<li>Adding/subtracting 1 would ensure that biases don't get
unnecessarily mitigated</li>
<li>Putting them on a ratio ensures that independent sentiment, which
usually leaves a higher impression, is put to greater effect.</li>
</ul>
<p>Now that is a bit better. Furthermore, this actually also solves the
issue of sentiment mitigation as when before, the average would always
decrease due to |V/AC| always being less than 1, now the average can
increase as |V/AC| can be greater than 1. Let's put this into code.</p>
</div>
<div class="cell code" data-execution_count="136">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_compound_sentiment(base_sentiment, other_sentiment, action_sentiment):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> other_sentiment <span class="op">&gt;=</span> <span class="dv">0</span>:</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        compound_sentiment <span class="op">=</span> ((other_sentiment <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> action_sentiment <span class="op">+</span> base_sentiment <span class="op">*</span> <span class="dv">3</span>) <span class="op">/</span> <span class="dv">4</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        compound_sentiment <span class="op">=</span> ((other_sentiment <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> action_sentiment <span class="op">+</span> base_sentiment <span class="op">*</span> <span class="dv">3</span>) <span class="op">/</span> <span class="dv">4</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> compound_sentiment</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Actor sentiment (Adam example):&quot;</span>, calculate_compound_sentiment(<span class="op">-</span><span class="fl">0.6808</span>, <span class="fl">0.0</span>, <span class="op">-</span><span class="fl">0.296</span>))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Victim sentiment (Adam example):&quot;</span>, calculate_compound_sentiment(<span class="fl">0.0</span>, <span class="op">-</span><span class="fl">0.6808</span>, <span class="op">-</span><span class="fl">0.296</span>))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Positive -&gt; positive -&gt; positive case</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Positive -&gt; positive -&gt; positive&quot;</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">&quot;The kind man positively helped the nice children.&quot;</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>ac <span class="op">=</span> <span class="st">&quot;The kind man&quot;</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>asca <span class="op">=</span> <span class="st">&quot;positively helped&quot;</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>vc <span class="op">=</span> <span class="st">&quot;the nice children&quot;</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>ac_s <span class="op">=</span> get_sentiment(ac)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>asca_s <span class="op">=</span> get_sentiment(asca)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>vc_s <span class="op">=</span> get_sentiment(vc)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;AC sentiment:&quot;</span>, ac_s)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;ASCA sentiment:&quot;</span>, asca_s)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;VC sentiment:&quot;</span>, vc_s)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Compound Actor sentiment (Random test):&quot;</span>, calculate_compound_sentiment(ac_s, asca_s, vc_s))</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Compound Victim sentiment (Random test):&quot;</span>, calculate_compound_sentiment(vc_s, asca_s, ac_s))</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Positive -&gt; positive -&gt; negative case</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Positive -&gt; positive -&gt; negative&quot;</span>)</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">&quot;The kind man positively helped the evil villians.&quot;</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>ac <span class="op">=</span> <span class="st">&quot;The kind man&quot;</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>asca <span class="op">=</span> <span class="st">&quot;positively helped&quot;</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>vc <span class="op">=</span> <span class="st">&quot;the evil villians&quot;</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>ac_s <span class="op">=</span> get_sentiment(ac)</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>asca_s <span class="op">=</span> get_sentiment(asca)</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>vc_s <span class="op">=</span> get_sentiment(vc)</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;AC sentiment:&quot;</span>, ac_s)</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;ASCA sentiment:&quot;</span>, asca_s)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;VC sentiment:&quot;</span>, vc_s)</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Compound Actor sentiment (Random test):&quot;</span>, calculate_compound_sentiment(ac_s, asca_s, vc_s))</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Compound Victim sentiment (Random test):&quot;</span>, calculate_compound_sentiment(vc_s, asca_s, ac_s))</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Positive -&gt; positive -&gt; negative case</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Positive -&gt; negative -&gt; positive&quot;</span>)</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">&quot;The kind man sucker punched the nice children.&quot;</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>ac <span class="op">=</span> <span class="st">&quot;The kind man&quot;</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>asca <span class="op">=</span> <span class="st">&quot;sucker punched&quot;</span></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>vc <span class="op">=</span> <span class="st">&quot;the nice children&quot;</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>ac_s <span class="op">=</span> get_sentiment(ac)</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>asca_s <span class="op">=</span> get_sentiment(asca)</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>vc_s <span class="op">=</span> get_sentiment(vc)</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;AC sentiment:&quot;</span>, ac_s)</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;ASCA sentiment:&quot;</span>, asca_s)</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;VC sentiment:&quot;</span>, vc_s)</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Compound Actor sentiment (Random test):&quot;</span>, calculate_compound_sentiment(ac_s, asca_s, vc_s))</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Compound Victim sentiment (Random test):&quot;</span>, calculate_compound_sentiment(vc_s, asca_s, ac_s))</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Positive -&gt; negative -&gt; negative case</span></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Positive -&gt; negative -&gt; negative&quot;</span>)</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">&quot;The kind man sucker punched the evil villians.&quot;</span></span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>ac <span class="op">=</span> <span class="st">&quot;The kind man&quot;</span></span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>asca <span class="op">=</span> <span class="st">&quot;sucker punched&quot;</span></span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>vc <span class="op">=</span> <span class="st">&quot;the evil villians&quot;</span></span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>ac_s <span class="op">=</span> get_sentiment(ac)</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>asca_s <span class="op">=</span> get_sentiment(asca)</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>vc_s <span class="op">=</span> get_sentiment(vc)</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;AC sentiment:&quot;</span>, ac_s)</span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;ASCA sentiment:&quot;</span>, asca_s)</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;VC sentiment:&quot;</span>, vc_s)</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Compound Actor sentiment (Random test):&quot;</span>, calculate_compound_sentiment(ac_s, asca_s, vc_s))</span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Compound Victim sentiment (Random test):&quot;</span>, calculate_compound_sentiment(vc_s, asca_s, ac_s))</span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Negative -&gt; negative -&gt; negative case</span></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Negative -&gt; negative -&gt; negative&quot;</span>)</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">&quot;The evil warlord brutally murdered the cruel dictator.&quot;</span></span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a>ac <span class="op">=</span> <span class="st">&quot;The evil warlord&quot;</span></span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a>asca <span class="op">=</span> <span class="st">&quot;brutally murdered&quot;</span></span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a>vc <span class="op">=</span> <span class="st">&quot;the cruel dictator&quot;</span></span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a>ac_s <span class="op">=</span> get_sentiment(ac)</span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a>asca_s <span class="op">=</span> get_sentiment(asca)</span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a>vc_s <span class="op">=</span> get_sentiment(vc)</span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;AC sentiment:&quot;</span>, ac_s)</span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;ASCA sentiment:&quot;</span>, asca_s)</span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;VC sentiment:&quot;</span>, vc_s)</span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Compound Actor sentiment (Random test):&quot;</span>, calculate_compound_sentiment(ac_s, asca_s, vc_s))</span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Compound Victim sentiment (Random test):&quot;</span>, calculate_compound_sentiment(vc_s, asca_s, ac_s))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Actor sentiment (Adam example): -0.5845999999999999
Victim sentiment (Adam example): 0.1243792

Positive -&gt; positive -&gt; positive
AC sentiment: 0.46335
ASCA sentiment: 0.46335
VC sentiment: 0.51075
Compound Actor sentiment (Random test): 0.534364003125
Compound Victim sentiment (Random test): 0.552573305625

Positive -&gt; positive -&gt; negative
AC sentiment: 0.46335
ASCA sentiment: 0.46335
VC sentiment: -0.62985
Compound Actor sentiment (Random test): 0.11708975062500002
Compound Victim sentiment (Random test): -0.30287669437500003

Positive -&gt; negative -&gt; positive
AC sentiment: 0.46335
ASCA sentiment: -0.26335
VC sentiment: 0.51075
Compound Actor sentiment (Random test): 0.18619849687499998
Compound Victim sentiment (Random test): 0.23671919437500002

Positive -&gt; negative -&gt; negative
AC sentiment: 0.46335
ASCA sentiment: -0.26335
VC sentiment: -0.62985
Compound Actor sentiment (Random test): 0.546442749375
Compound Victim sentiment (Random test): -0.618730805625

Negative -&gt; negative -&gt; negative
AC sentiment: -0.62985
ASCA sentiment: -0.72775
VC sentiment: -0.59295
Compound Actor sentiment (Random test): -0.21627015937500005
Compound Victim sentiment (Random test): -0.17265666562499998
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>And the results are pretty satisfactory, each example relatively
accurately illustrate how the sentiment should play out.</p>
<p>Now, let's get to the final and (possibly) most difficult part:
determining the difference between descriptive and evaluative words.</p>
<p>First, let's define the difference between descriptive and evaluative
words. Descriptive words are primarily words that observe versus
evaluative words being words that judge. This chart below contains a few
examples:</p>
<table>
<thead>
<tr class="header">
<th>Descriptive</th>
<th>Evaluative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tall, short, loud, quiet</td>
<td>nice, bad, corrupt, amazing</td>
</tr>
</tbody>
</table>
<p>Now let's look at what the sentiment analyzers say about them!</p>
</div>
<div class="cell code" data-execution_count="139">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Descriptive:&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Tall:&quot;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Afinn score:&quot;</span>, afn.score(<span class="st">&quot;tall&quot;</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Vader score:&quot;</span>, sia.polarity_scores(<span class="st">&quot;tall&quot;</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Short:&quot;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Afinn score:&quot;</span>, afn.score(<span class="st">&quot;short&quot;</span>))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Vader score:&quot;</span>, sia.polarity_scores(<span class="st">&quot;short&quot;</span>))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Loud:&quot;</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Afinn score:&quot;</span>, afn.score(<span class="st">&quot;loud&quot;</span>))</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Vader score:&quot;</span>, sia.polarity_scores(<span class="st">&quot;loud&quot;</span>))</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Quiet:&quot;</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Afinn score:&quot;</span>, afn.score(<span class="st">&quot;quiet&quot;</span>))</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Vader score:&quot;</span>, sia.polarity_scores(<span class="st">&quot;quiet&quot;</span>))</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">Evaluative&quot;</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Nice:&quot;</span>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Afinn score:&quot;</span>, afn.score(<span class="st">&quot;nice&quot;</span>))</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Vader score:&quot;</span>, sia.polarity_scores(<span class="st">&quot;nice&quot;</span>))</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Bad:&quot;</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Afinn score:&quot;</span>, afn.score(<span class="st">&quot;bad&quot;</span>))</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Vader score:&quot;</span>, sia.polarity_scores(<span class="st">&quot;bad&quot;</span>))</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Corrupt:&quot;</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Afinn score:&quot;</span>, afn.score(<span class="st">&quot;corrupt&quot;</span>))</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Vader score:&quot;</span>, sia.polarity_scores(<span class="st">&quot;corrupt&quot;</span>))</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Amazing:&quot;</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Afinn score:&quot;</span>, afn.score(<span class="st">&quot;amazing&quot;</span>))</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Vader score:&quot;</span>, sia.polarity_scores(<span class="st">&quot;amazing&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Descriptive:

Tall:
Afinn score: 0.0
Vader score: {&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}

Short:
Afinn score: 0.0
Vader score: {&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}

Loud:
Afinn score: 0.0
Vader score: {&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}

Quiet:
Afinn score: 0.0
Vader score: {&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}


Evaluative

Nice:
Afinn score: 3.0
Vader score: {&#39;neg&#39;: 0.0, &#39;neu&#39;: 0.0, &#39;pos&#39;: 1.0, &#39;compound&#39;: 0.4215}

Bad:
Afinn score: -3.0
Vader score: {&#39;neg&#39;: 1.0, &#39;neu&#39;: 0.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: -0.5423}

Corrupt:
Afinn score: -3.0
Vader score: {&#39;neg&#39;: 0.0, &#39;neu&#39;: 1.0, &#39;pos&#39;: 0.0, &#39;compound&#39;: 0.0}

Amazing:
Afinn score: 4.0
Vader score: {&#39;neg&#39;: 0.0, &#39;neu&#39;: 0.0, &#39;pos&#39;: 1.0, &#39;compound&#39;: 0.5859}
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Well... how surprising! It turns out: the perceived issue wasn't an
issue at all! AFINN and Vader had it covered! That means that all three
major issues in calculating sentiment have been completed.</p>
<p>However, we am not done yet! There are still two things we need to
do:</p>
<p>First, remember how we split everything into: Actor Clause -&gt;
Action -&gt; Victim Clause? Well, we need to figure out how to do
that.</p>
<p>Secondly, we need to consider everything that doesn't fall under the
category of transitive verbs constructions, which is basically just any
sentence without a direct object. Getting sentiment for these types of
sentences are pretty easy, but we need to be able to be able to locate
independant clauses and the such to actually properly calculate
sentiment.</p>
<p>That being said, let's get started with the first issue.</p>
<p>First, I had a quick look through all the sentences to extract the
patterns and they ended up below.</p>
<p>Active Voice:</p>
<ul>
<li>Actor: nsubj and all subtrees</li>
<li>Action: Verb + xcomp (excluding prep subtrees)</li>
<li>Victim: dobj and all subtrees</li>
</ul>
<p>Passive Voice:</p>
<ul>
<li>Actor: pobj and all subtrees</li>
<li>Action: Verb + auxpass + agent</li>
<li>Victim: nsubjpass and all subtrees</li>
</ul>
<p>Active Voice + Final Prepositional Phrase Modifier:</p>
<ul>
<li>Actor: nsubj and all subtrees + prep</li>
<li>Action: Verb + xcomp (excluding prep subtrees)</li>
<li>Victim: dobj and all subtrees</li>
</ul>
<p>Active Voice (Complex Sentence):</p>
<ul>
<li>Actor: nsubj and all subtrees + advcl and all subtrees</li>
<li>Action: Verb + xcomp (excluding prep subtrees)</li>
<li>Victim: dobj and all subtrees</li>
</ul>
<p>Passive Voice + Final Prepositional Phrase Modifier:</p>
<ul>
<li>Actor: pobj and all subtrees + prep</li>
<li>Action: Verb + xcomp (excluding prep subtrees)</li>
<li>Victim: nsubjpass and all subtrees</li>
</ul>
<p>Passive Voice (Complex Sentence):</p>
<ul>
<li>Actor: dobj and all subtrees</li>
<li>Action: Verb + xcomp (excluding prep subtrees)</li>
<li>Victim: advcl + nsubjpass</li>
</ul>
</div>
<div class="cell code">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_sentence_root(doc):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [sent.root <span class="cf">for</span> sent <span class="kw">in</span> doc.sents]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_tokens_by_dependencies(doc, target_deps):</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [token <span class="cf">for</span> token <span class="kw">in</span> doc <span class="cf">if</span> token.dep_ <span class="kw">in</span> target_deps]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_full_subtree(token, exclude_branch_types<span class="op">=</span>[]):</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    subtree_tokens <span class="op">=</span> []</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> traverse_subtree(token):</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> token.dep_ <span class="kw">not</span> <span class="kw">in</span> exclude_branch_types:</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>            subtree_tokens.append(token)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> child <span class="kw">in</span> token.children:</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                traverse_subtree(child)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    traverse_subtree(token)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(subtree_tokens, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_dependency(doc, target_dep):</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">any</span>(token.dep_ <span class="op">==</span> target_dep <span class="cf">for</span> token <span class="kw">in</span> doc)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_named_entities_token(tokens):</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    allowed_labels <span class="op">=</span> {<span class="st">&quot;PERSON&quot;</span>, <span class="st">&quot;ORG&quot;</span>, <span class="st">&quot;GPE&quot;</span>, <span class="st">&quot;NORP&quot;</span>, <span class="st">&quot;FAC&quot;</span>, <span class="st">&quot;PRODUCT&quot;</span>, <span class="st">&quot;EVENT&quot;</span>}</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    token_idxs <span class="op">=</span> {t.i <span class="cf">for</span> t <span class="kw">in</span> tokens}</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    doc <span class="op">=</span> tokens[<span class="dv">0</span>].doc</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    ents <span class="op">=</span> []</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ent <span class="kw">in</span> doc.ents:</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> ent.label_ <span class="kw">in</span> allowed_labels <span class="kw">and</span> <span class="bu">all</span>(t.i <span class="kw">in</span> token_idxs <span class="cf">for</span> t <span class="kw">in</span> ent):</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>            ents.append(ent.text)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ents</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_named_entities(doc):</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    allowed_labels <span class="op">=</span> {<span class="st">&quot;PERSON&quot;</span>, <span class="st">&quot;ORG&quot;</span>, <span class="st">&quot;GPE&quot;</span>, <span class="st">&quot;NORP&quot;</span>, <span class="st">&quot;FAC&quot;</span>, <span class="st">&quot;PRODUCT&quot;</span>, <span class="st">&quot;EVENT&quot;</span>}</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    ents <span class="op">=</span> []</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ent <span class="kw">in</span> doc.ents:</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> ent.label_ <span class="kw">in</span> allowed_labels:</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>            ents.append(ent.text)</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> split_into_independent_clauses(text):</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    doc <span class="op">=</span> nlp(text)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    clauses <span class="op">=</span> []</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sent <span class="kw">in</span> doc.sents:</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>        tokens <span class="op">=</span> <span class="bu">list</span>(sent)</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>        boundaries <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, token <span class="kw">in</span> <span class="bu">enumerate</span>(tokens):</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> token.dep_ <span class="kw">in</span> {<span class="st">&quot;cc&quot;</span>, <span class="st">&quot;conj&quot;</span>}:</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>                boundaries.append(i)</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>        boundaries.append(<span class="bu">len</span>(tokens))</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(boundaries) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>            clause_tokens <span class="op">=</span> tokens[boundaries[i]:boundaries[i<span class="op">+</span><span class="dv">1</span>]]</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>            clause_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join(t.text <span class="cf">for</span> t <span class="kw">in</span> clause_tokens).strip()</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> clause_text.lower().startswith((<span class="st">&quot;and &quot;</span>, <span class="st">&quot;or &quot;</span>, <span class="st">&quot;but &quot;</span>)):</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>                clause_text <span class="op">=</span> clause_text.split(<span class="st">&quot; &quot;</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> clause_text:</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>                clauses.append(clause_text)</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> clauses</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_ac_asca_vc(text):</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>    doc <span class="op">=</span> nlp(text)</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> has_dependency(doc, <span class="st">&#39;nsubj&#39;</span>) <span class="kw">and</span> has_dependency(doc, <span class="st">&#39;dobj&#39;</span>):</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>        ac_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;nsubj&#39;</span>])</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>        ac_base_subtree <span class="op">=</span> get_full_subtree(ac_base[<span class="dv">0</span>])</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>        ac_prep_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;prep&#39;</span>])[<span class="dv">0</span>] <span class="cf">if</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;prep&#39;</span>]) <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>        ac_prep_base_subtree <span class="op">=</span> get_full_subtree(ac_prep_base) <span class="cf">if</span> ac_prep_base <span class="cf">else</span> []</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>        ac_advcl_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;advcl&#39;</span>])[<span class="dv">0</span>] <span class="cf">if</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;advcl&#39;</span>]) <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>        ac_advcl_base_subtree <span class="op">=</span> get_full_subtree(ac_advcl_base) <span class="cf">if</span> ac_advcl_base <span class="cf">else</span> []</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>        ac_full <span class="op">=</span> ac_base_subtree <span class="op">+</span> ac_prep_base_subtree <span class="op">+</span> ac_advcl_base_subtree</span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>        ac_full <span class="op">=</span> <span class="bu">sorted</span>(ac_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>        ac_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> ac_full])</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>        a_base <span class="op">=</span> get_sentence_root(doc)</span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>        a_base_subtree <span class="op">=</span> get_full_subtree(a_base[<span class="dv">0</span>], [<span class="st">&quot;nsubj&quot;</span>, <span class="st">&quot;dobj&quot;</span>, <span class="st">&quot;prep&quot;</span>, <span class="st">&quot;advcl&quot;</span>, <span class="st">&quot;dative&quot;</span>])</span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>        a_full <span class="op">=</span> <span class="bu">sorted</span>(a_base_subtree, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>        a_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> a_full])</span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>        asca_full <span class="op">=</span> ac_base <span class="op">+</span> a_full</span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>        asca_full <span class="op">=</span> <span class="bu">sorted</span>(asca_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>        asca_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> asca_full])</span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>        vc_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;dobj&#39;</span>])</span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>        vc_base_subtree <span class="op">=</span> get_full_subtree(vc_base[<span class="dv">0</span>])</span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>        vc_dative_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;dative&#39;</span>])</span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>        vc_dative_base_subtree <span class="op">=</span> get_full_subtree(vc_dative_base[<span class="dv">0</span>]) <span class="cf">if</span> vc_dative_base <span class="cf">else</span> []</span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>        vc_full <span class="op">=</span> vc_base_subtree <span class="op">+</span> vc_dative_base_subtree</span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>        vc_full <span class="op">=</span> <span class="bu">sorted</span>(vc_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>        vc_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> vc_full])</span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>        named_entities_actor <span class="op">=</span> extract_named_entities_token(ac_full)</span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>        named_entities_victim <span class="op">=</span> extract_named_entities_token(vc_full)</span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ac_full_text, a_full_text, asca_full_text, vc_full_text, named_entities_actor, named_entities_victim</span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> has_dependency(doc, <span class="st">&#39;nsubjpass&#39;</span>) <span class="kw">and</span> has_dependency(doc, <span class="st">&#39;pobj&#39;</span>):</span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>        ac_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;pobj&#39;</span>])</span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>        ac_base_subtree <span class="op">=</span> get_full_subtree(ac_base[<span class="dv">0</span>])</span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>        full_prep_tokens <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;prep&#39;</span>])</span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>        ac_prep_base <span class="op">=</span> full_prep_tokens[<span class="op">-</span><span class="dv">1</span>] <span class="cf">if</span> <span class="bu">len</span>(full_prep_tokens) <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> full_prep_tokens[<span class="dv">0</span>]</span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>        ac_prep_base_subtree <span class="op">=</span> get_full_subtree(ac_prep_base) <span class="cf">if</span> ac_prep_base <span class="cf">else</span> []</span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>        ac_full <span class="op">=</span> ac_base_subtree <span class="op">+</span> ac_prep_base_subtree <span class="cf">if</span> <span class="bu">len</span>(full_prep_tokens) <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> ac_prep_base_subtree</span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a>        ac_full <span class="op">=</span> <span class="bu">sorted</span>(ac_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a>        ac_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> ac_full])</span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a>        a_base <span class="op">=</span> get_sentence_root(doc)</span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a>        a_base_subtree <span class="op">=</span> get_full_subtree(a_base[<span class="dv">0</span>], [<span class="st">&quot;nsubjpass&quot;</span>, <span class="st">&quot;pobj&quot;</span>, <span class="st">&quot;prep&quot;</span>, <span class="st">&quot;advcl&quot;</span>, <span class="st">&quot;dative&quot;</span>])</span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a>        a_full <span class="op">=</span> <span class="bu">sorted</span>(a_base_subtree, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a>        a_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> a_full])</span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>        asca_full <span class="op">=</span> [ac_base[<span class="dv">0</span>], get_tokens_by_dependencies(doc, [<span class="st">&#39;prep&#39;</span>])[<span class="dv">0</span>]] <span class="op">+</span> a_full</span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a>        asca_full <span class="op">=</span> <span class="bu">sorted</span>(asca_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a>        asca_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> asca_full])</span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-109"><a href="#cb23-109" aria-hidden="true" tabindex="-1"></a>        vc_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;nsubjpass&#39;</span>])</span>
<span id="cb23-110"><a href="#cb23-110" aria-hidden="true" tabindex="-1"></a>        vc_base_subtree <span class="op">=</span> get_full_subtree(vc_base[<span class="dv">0</span>])</span>
<span id="cb23-111"><a href="#cb23-111" aria-hidden="true" tabindex="-1"></a>        vc_dative_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;dative&#39;</span>])</span>
<span id="cb23-112"><a href="#cb23-112" aria-hidden="true" tabindex="-1"></a>        vc_dative_base_subtree <span class="op">=</span> get_full_subtree(vc_dative_base[<span class="dv">0</span>]) <span class="cf">if</span> vc_dative_base <span class="cf">else</span> []</span>
<span id="cb23-113"><a href="#cb23-113" aria-hidden="true" tabindex="-1"></a>        vc_full <span class="op">=</span> vc_base_subtree <span class="op">+</span> vc_dative_base_subtree</span>
<span id="cb23-114"><a href="#cb23-114" aria-hidden="true" tabindex="-1"></a>        vc_full <span class="op">=</span> <span class="bu">sorted</span>(vc_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb23-115"><a href="#cb23-115" aria-hidden="true" tabindex="-1"></a>        vc_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> vc_full])</span>
<span id="cb23-116"><a href="#cb23-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-117"><a href="#cb23-117" aria-hidden="true" tabindex="-1"></a>        named_entities_actor <span class="op">=</span> extract_named_entities_token(ac_full)</span>
<span id="cb23-118"><a href="#cb23-118" aria-hidden="true" tabindex="-1"></a>        named_entities_victim <span class="op">=</span> extract_named_entities_token(vc_full)</span>
<span id="cb23-119"><a href="#cb23-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ac_full_text, a_full_text, asca_full_text, vc_full_text, named_entities_actor, named_entities_victim</span>
<span id="cb23-120"><a href="#cb23-120" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb23-121"><a href="#cb23-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>, [], []</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Given all of that, we have a basic rule-based method for transitive
verbs constructions! Yay! Just as a disclaimer though: This is
completely cobbled together and in no way accurate/proper. That being
said, let's start testing.</p>
</div>
<div class="cell code" data-execution_count="225">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test cases</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(extract_ac_asca_vc(<span class="st">&quot;Adam and Alice ordered John to stop eating in a late-night hateful rant.&quot;</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(extract_ac_asca_vc(<span class="st">&quot;While ranting hatefully, Adam ordered John to stop eating.&quot;</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(extract_ac_asca_vc(<span class="st">&quot;Adam, a horrible person, ordered John to stop eating.&quot;</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(extract_ac_asca_vc(<span class="st">&quot;John was ordered to stop eating by Adam in a late-night hateful rant.&quot;</span>))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(extract_ac_asca_vc(<span class="st">&quot;While ranting hatefully, John was ordered to stop eating by Adam.&quot;</span>))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Actual example texts from </span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(extract_ac_asca_vc(<span class="st">&quot;The best road trip in Boston history has given the Celtics a chance at grabbing a piece of NBA history.&quot;</span>))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(extract_ac_asca_vc(<span class="st">&quot;The waspâ€™s flaps and teeth-like hairs resemble the structure of the carnivorous Venus flytrap plant, which snaps shut to digest unsuspecting insects.&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(&#39;Adam and Alice in a late - night hateful rant&#39;, &#39;ordered to stop eating .&#39;, &#39;Adam ordered to stop eating .&#39;, &#39;John&#39;, [&#39;Adam&#39;, &#39;Alice&#39;], [&#39;John&#39;])
(&#39;While ranting hatefully Adam&#39;, &#39;, ordered to stop eating .&#39;, &#39;, Adam ordered to stop eating .&#39;, &#39;John&#39;, [&#39;Adam&#39;], [&#39;John&#39;])
(&#39;Adam , a horrible person ,&#39;, &#39;ordered to stop eating .&#39;, &#39;Adam ordered to stop eating .&#39;, &#39;John&#39;, [&#39;Adam&#39;], [&#39;John&#39;])
(&#39;Adam in a late - night hateful rant&#39;, &#39;was ordered to stop eating .&#39;, &#39;was ordered to stop eating by Adam .&#39;, &#39;John&#39;, [&#39;Adam&#39;], [&#39;John&#39;])
(&#39;by Adam&#39;, &#39;, was ordered to stop eating .&#39;, &#39;, was ordered to stop eating by Adam .&#39;, &#39;John&#39;, [&#39;Adam&#39;], [&#39;John&#39;])

(&#39;The best road trip in in Boston Boston history history&#39;, &#39;has given .&#39;, &#39;trip has given .&#39;, &#39;the Celtics a chance at grabbing a piece of NBA history&#39;, [], [])
(&#39;The wasp â€™s of the carnivorous Venus flytrap plant , which snaps shut to to digest digest unsuspecting unsuspecting insects insects&#39;, &#39;resemble .&#39;, &#39;wasp hairs resemble which snaps .&#39;, &#39;the structure of the carnivorous Venus flytrap plant , which snaps shut to digest unsuspecting insects&#39;, [], [])
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Well, we have some successes and some failures, which is natural as
the rule-based structure needs to be continuously updated, something of
which I will continue to do later on. However, for now, it is generally
satisfactory, though it fails real-world tests. That being said, let's
get to the second issue: anything that doesn't fall under the category
of transitive verbs constructions. The solution to this is very easyâ€”as
there aren't two different verbs, sentiment can only be aimed at a
single thing! So let's update some things real quick.</p>
</div>
<div class="cell code" data-execution_count="229">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_ac_asca_vc(text):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    doc <span class="op">=</span> nlp(text)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> has_dependency(doc, <span class="st">&#39;nsubj&#39;</span>) <span class="kw">and</span> has_dependency(doc, <span class="st">&#39;dobj&#39;</span>):</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        ac_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;nsubj&#39;</span>])</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        ac_base_subtree <span class="op">=</span> get_full_subtree(ac_base[<span class="dv">0</span>])</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        ac_prep_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;prep&#39;</span>])[<span class="dv">0</span>] <span class="cf">if</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;prep&#39;</span>]) <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        ac_prep_base_subtree <span class="op">=</span> get_full_subtree(ac_prep_base) <span class="cf">if</span> ac_prep_base <span class="cf">else</span> []</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        ac_advcl_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;advcl&#39;</span>])[<span class="dv">0</span>] <span class="cf">if</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;advcl&#39;</span>]) <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        ac_advcl_base_subtree <span class="op">=</span> get_full_subtree(ac_advcl_base) <span class="cf">if</span> ac_advcl_base <span class="cf">else</span> []</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        ac_full <span class="op">=</span> ac_base_subtree <span class="op">+</span> ac_prep_base_subtree <span class="op">+</span> ac_advcl_base_subtree</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        ac_full <span class="op">=</span> <span class="bu">sorted</span>(ac_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        ac_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> ac_full])</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        a_base <span class="op">=</span> get_sentence_root(doc)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        a_base_subtree <span class="op">=</span> get_full_subtree(a_base[<span class="dv">0</span>], [<span class="st">&quot;nsubj&quot;</span>, <span class="st">&quot;dobj&quot;</span>, <span class="st">&quot;prep&quot;</span>, <span class="st">&quot;advcl&quot;</span>, <span class="st">&quot;dative&quot;</span>])</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        a_full <span class="op">=</span> <span class="bu">sorted</span>(a_base_subtree, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>        a_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> a_full])</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        asca_full <span class="op">=</span> ac_base <span class="op">+</span> a_full</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>        asca_full <span class="op">=</span> <span class="bu">sorted</span>(asca_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>        asca_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> asca_full])</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>        vc_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;dobj&#39;</span>])</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>        vc_base_subtree <span class="op">=</span> get_full_subtree(vc_base[<span class="dv">0</span>])</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>        vc_dative_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;dative&#39;</span>])</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>        vc_dative_base_subtree <span class="op">=</span> get_full_subtree(vc_dative_base[<span class="dv">0</span>]) <span class="cf">if</span> vc_dative_base <span class="cf">else</span> []</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>        vc_full <span class="op">=</span> vc_base_subtree <span class="op">+</span> vc_dative_base_subtree</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>        vc_full <span class="op">=</span> <span class="bu">sorted</span>(vc_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>        vc_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> vc_full])</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>        named_entities_actor <span class="op">=</span> extract_named_entities_token(ac_full)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>        named_entities_victim <span class="op">=</span> extract_named_entities_token(vc_full)</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">&#39;type&#39;</span>: <span class="st">&#39;tvc&#39;</span>, <span class="st">&#39;output&#39;</span>: (ac_full_text, a_full_text, asca_full_text, vc_full_text, named_entities_actor, named_entities_victim)}</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> has_dependency(doc, <span class="st">&#39;nsubjpass&#39;</span>) <span class="kw">and</span> has_dependency(doc, <span class="st">&#39;pobj&#39;</span>):</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>        ac_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;pobj&#39;</span>])</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>        ac_base_subtree <span class="op">=</span> get_full_subtree(ac_base[<span class="dv">0</span>])</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>        full_prep_tokens <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;prep&#39;</span>])</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>        ac_prep_base <span class="op">=</span> full_prep_tokens[<span class="op">-</span><span class="dv">1</span>] <span class="cf">if</span> <span class="bu">len</span>(full_prep_tokens) <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> full_prep_tokens[<span class="dv">0</span>]</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>        ac_prep_base_subtree <span class="op">=</span> get_full_subtree(ac_prep_base) <span class="cf">if</span> ac_prep_base <span class="cf">else</span> []</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>        ac_full <span class="op">=</span> ac_base_subtree <span class="op">+</span> ac_prep_base_subtree <span class="cf">if</span> <span class="bu">len</span>(full_prep_tokens) <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> ac_prep_base_subtree</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>        ac_full <span class="op">=</span> <span class="bu">sorted</span>(ac_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>        ac_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> ac_full])</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>        a_base <span class="op">=</span> get_sentence_root(doc)</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>        a_base_subtree <span class="op">=</span> get_full_subtree(a_base[<span class="dv">0</span>], [<span class="st">&quot;nsubjpass&quot;</span>, <span class="st">&quot;pobj&quot;</span>, <span class="st">&quot;prep&quot;</span>, <span class="st">&quot;advcl&quot;</span>, <span class="st">&quot;dative&quot;</span>])</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>        a_full <span class="op">=</span> <span class="bu">sorted</span>(a_base_subtree, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>        a_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> a_full])</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>        asca_full <span class="op">=</span> [ac_base[<span class="dv">0</span>], get_tokens_by_dependencies(doc, [<span class="st">&#39;prep&#39;</span>])[<span class="dv">0</span>]] <span class="op">+</span> a_full</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>        asca_full <span class="op">=</span> <span class="bu">sorted</span>(asca_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>        asca_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> asca_full])</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>        vc_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;nsubjpass&#39;</span>])</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>        vc_base_subtree <span class="op">=</span> get_full_subtree(vc_base[<span class="dv">0</span>])</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>        vc_dative_base <span class="op">=</span> get_tokens_by_dependencies(doc, [<span class="st">&#39;dative&#39;</span>])</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>        vc_dative_base_subtree <span class="op">=</span> get_full_subtree(vc_dative_base[<span class="dv">0</span>]) <span class="cf">if</span> vc_dative_base <span class="cf">else</span> []</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>        vc_full <span class="op">=</span> vc_base_subtree <span class="op">+</span> vc_dative_base_subtree</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>        vc_full <span class="op">=</span> <span class="bu">sorted</span>(vc_full, key<span class="op">=</span><span class="kw">lambda</span> t: t.i)</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>        vc_full_text <span class="op">=</span> <span class="st">&quot; &quot;</span>.join([token.text <span class="cf">for</span> token <span class="kw">in</span> vc_full])</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>        named_entities_actor <span class="op">=</span> extract_named_entities_token(ac_full)</span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>        named_entities_victim <span class="op">=</span> extract_named_entities_token(vc_full)</span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">&#39;type&#39;</span>: <span class="st">&#39;tvc&#39;</span>, <span class="st">&#39;output&#39;</span>: (ac_full_text, a_full_text, asca_full_text, vc_full_text, named_entities_actor, named_entities_victim)}</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">&#39;type&#39;</span>: <span class="st">&#39;ntvc&#39;</span>, <span class="st">&#39;output&#39;</span>: (extract_named_entities(doc))}</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Let's try this out.</p>
</div>
<div class="cell code" data-execution_count="230">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(extract_ac_asca_vc(<span class="st">&quot;Jerry was very upset and sad.&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>{&#39;type&#39;: &#39;ntvc&#39;, &#39;output&#39;: [&#39;Jerry&#39;]}
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Yup, works as expected.</p>
<p>Thus, the barebones of the project is complete. We have a basic,
heuristic, rule-based method to calculate enitty-targeted sentiment!
Yay!</p>
<p>However, as always, this isn't perfect. The main thing we need to
improve is the rule-based actor-action-victim extraction and everything
will be set. But for now, I need a small brain break.</p>
<p>Cheers!</p>
</div>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"9295a58d29895c18","version":"2025.1.0","r":1,"token":"0357a45f23a943f08700f7f9af191ee6","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}}}' crossorigin="anonymous"></script>
</body>
</html>
